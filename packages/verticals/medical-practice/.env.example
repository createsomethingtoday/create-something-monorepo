# Medical Practice Template - Environment Variables
# Copy this file to .env and configure with your values

# ============================================================================
# PUBLIC VARIABLES (included in client bundle)
# ============================================================================

# Your production site URL
PUBLIC_SITE_URL=https://yourpractice.com

# Practice name (for meta tags)
PUBLIC_PRACTICE_NAME="Your Practice Name"

# ============================================================================
# CLOUDFLARE (Auto-configured via wrangler.toml bindings)
# ============================================================================

# These are bound automatically in production:
# - DB (D1 Database)
# - KV (KV Namespace)
# - R2 (R2 Bucket)

# For local development, use wrangler dev or configure .dev.vars

# ============================================================================
# AUTHENTICATION (if implementing patient portal)
# ============================================================================

# Auth0 Configuration
# HIPAA: Requires Auth0 BAA (available on Enterprise plans)
AUTH0_DOMAIN=yourpractice.us.auth0.com
AUTH0_CLIENT_ID=your_client_id
AUTH0_CLIENT_SECRET=your_client_secret

# OR Clerk Configuration
# HIPAA: Requires Clerk BAA (available on Pro plans)
# CLERK_SECRET_KEY=sk_live_xxxxx
# PUBLIC_CLERK_PUBLISHABLE_KEY=pk_live_xxxxx

# Session Configuration
AUTH_SECRET=generate-a-secure-random-string-here  # Use: openssl rand -base64 32
SESSION_TIMEOUT=900  # 15 minutes (900 seconds) - HIPAA recommended
SESSION_ABSOLUTE_TIMEOUT=3600  # 1 hour absolute timeout

# ============================================================================
# EMAIL (for appointment reminders, notifications)
# ============================================================================

# SendGrid Configuration
# HIPAA: Requires SendGrid Pro plan + BAA
# See: https://docs.sendgrid.com/ui/account-and-settings/hipaa
SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxx
SENDGRID_FROM_EMAIL=noreply@yourpractice.com
SENDGRID_FROM_NAME="Your Practice Name"

# Email Templates (SendGrid dynamic template IDs)
EMAIL_TEMPLATE_APPOINTMENT_CONFIRMATION=d-xxxxx
EMAIL_TEMPLATE_APPOINTMENT_REMINDER=d-xxxxx
EMAIL_TEMPLATE_APPOINTMENT_CANCELLATION=d-xxxxx

# HIPAA Compliant Email Settings
EMAIL_ENCRYPT_PHI=true  # Encrypt any PHI in email content
EMAIL_REQUIRE_TLS=true  # Require TLS for email transmission

# ============================================================================
# SMS (for appointment reminders)
# ============================================================================

# Twilio Configuration
# HIPAA: Requires Twilio BAA
# See: https://www.twilio.com/en-us/legal/hipaa
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your_auth_token
TWILIO_PHONE_NUMBER=+15551234567

# HIPAA Compliant SMS Settings
# Patient consent required before sending SMS
SMS_REQUIRE_CONSENT=true
SMS_USE_SHORT_CODE=false  # Use long code for HIPAA compliance

# ============================================================================
# APPOINTMENT BOOKING
# ============================================================================

# Calendly Configuration
# HIPAA: Requires Calendly BAA (available on Teams plan)
# See: https://help.calendly.com/hc/en-us/articles/360056383734
CALENDLY_API_KEY=your_calendly_api_key
CALENDLY_EVENT_TYPE_UUID=your_event_type_uuid

# OR Custom Booking Implementation
# BOOKING_PROVIDER=custom

# ============================================================================
# EHR INTEGRATION (Enterprise only)
# ============================================================================

# athenahealth Configuration
# HIPAA: athenahealth is HIPAA compliant, BAA included
# ATHENA_CLIENT_ID=your_client_id
# ATHENA_CLIENT_SECRET=your_client_secret
# ATHENA_PRACTICE_ID=your_practice_id

# Epic Configuration (Enterprise)
# EPIC_CLIENT_ID=your_client_id
# EPIC_FHIR_ENDPOINT=https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4

# Cerner Configuration (Enterprise)
# CERNER_CLIENT_ID=your_client_id
# CERNER_FHIR_ENDPOINT=https://fhir-myrecord.cerner.com/r4/xxxxx

# ============================================================================
# INSURANCE VERIFICATION (Enterprise)
# ============================================================================

# Availity Configuration (insurance verification)
# AVAILITY_CLIENT_ID=your_client_id
# AVAILITY_CLIENT_SECRET=your_client_secret

# ============================================================================
# HIPAA COMPLIANCE
# ============================================================================

# Encryption key for PHI data (CRITICAL - generate securely)
# Generate: openssl rand -base64 32
HIPAA_ENCRYPTION_KEY=your-secure-encryption-key-here-DO-NOT-COMMIT

# Encryption algorithm (default: AES-256-GCM)
HIPAA_ENCRYPTION_ALGORITHM=aes-256-gcm

# Audit logging configuration
AUDIT_LOG_ENABLED=true  # REQUIRED for HIPAA
AUDIT_LOG_DESTINATION=d1  # Options: d1, cloudflare-logs, external
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years (HIPAA requirement)

# Data retention policy
DATA_RETENTION_DAYS=2555  # 7 years for medical records
BACKUP_RETENTION_DAYS=2555

# Breach notification email (HIPAA compliance officer)
HIPAA_COMPLIANCE_EMAIL=compliance@yourpractice.com

# ============================================================================
# LOGGING & MONITORING
# ============================================================================

# Cloudflare Logpush (HIPAA: Required for audit trail)
# Configure via Cloudflare dashboard or API
# LOGPUSH_DESTINATION=s3://your-bucket/logs  # or Azure Blob, GCS

# External logging (optional)
# Datadog Configuration
# DATADOG_API_KEY=your_datadog_api_key
# DATADOG_SITE=datadoghq.com

# Splunk Configuration
# SPLUNK_HEC_TOKEN=your_splunk_token
# SPLUNK_HEC_URL=https://your-splunk.com:8088

# ============================================================================
# SECURITY
# ============================================================================

# Rate limiting (DDoS protection)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_REQUESTS_PER_HOUR=1000

# CAPTCHA (for public forms)
# hCaptcha (GDPR/HIPAA friendly)
HCAPTCHA_SECRET_KEY=0x0000000000000000000000000000000000000000
PUBLIC_HCAPTCHA_SITE_KEY=00000000-0000-0000-0000-000000000000

# Content Security Policy
CSP_REPORT_URI=https://yourpractice.report-uri.com/r/d/csp/enforce

# ============================================================================
# ANALYTICS (ensure HIPAA compliance)
# ============================================================================

# Google Analytics 4 (NOT HIPAA compliant without BAA)
# DO NOT USE if tracking patient behavior on authenticated pages
# PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX

# Privacy-focused alternatives (HIPAA safer)
# Plausible Analytics (self-hosted or cloud with BAA)
# PUBLIC_PLAUSIBLE_DOMAIN=yourpractice.com

# Cloudflare Web Analytics (no PHI tracking, privacy-first)
PUBLIC_CLOUDFLARE_ANALYTICS_TOKEN=your_token

# ============================================================================
# DEVELOPMENT ONLY
# ============================================================================

# Mock mode (bypasses external services for testing)
MOCK_MODE=false

# Debug logging (NEVER enable in production with PHI)
DEBUG_ENABLED=false

# Disable HIPAA checks (DEVELOPMENT ONLY)
DISABLE_HIPAA_CHECKS=false

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable patient portal
FEATURE_PATIENT_PORTAL=false  # Set to true after HIPAA configuration

# Enable online appointment booking
FEATURE_ONLINE_BOOKING=true

# Enable appointment reminders
FEATURE_APPOINTMENT_REMINDERS=false  # Requires patient consent + BAA

# Enable patient intake forms
FEATURE_INTAKE_FORMS=false  # HIPAA configuration required

# Enable insurance verification
FEATURE_INSURANCE_VERIFICATION=false  # Enterprise only

# Enable telemedicine (Enterprise)
FEATURE_TELEMEDICINE=false

# ============================================================================
# IMPORTANT NOTES
# ============================================================================

# 1. NEVER commit .env to version control
# 2. Use wrangler secrets for production:
#    wrangler secret put SENDGRID_API_KEY
#    wrangler secret put HIPAA_ENCRYPTION_KEY
# 3. Rotate secrets regularly (quarterly minimum)
# 4. All services handling PHI require Business Associate Agreements
# 5. Consult HIPAA_COMPLIANCE.md before enabling PHI features
# 6. Test in development environment first
# 7. Conduct security audit before production deployment

# ============================================================================
# CLOUDFLARE WRANGLER SECRETS
# ============================================================================

# For production, set these as Wrangler secrets instead of .env:
# wrangler secret put AUTH0_CLIENT_SECRET
# wrangler secret put SENDGRID_API_KEY
# wrangler secret put TWILIO_AUTH_TOKEN
# wrangler secret put HIPAA_ENCRYPTION_KEY
# wrangler secret put ATHENA_CLIENT_SECRET

# List all secrets:
# wrangler secret list

# Delete a secret:
# wrangler secret delete SECRET_NAME
