# Medical Practice Vertical Template
# Powered by CREATE SOMETHING Canon + WORKWAY

name = "medical-practice-template"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

pages_build_output_dir = ".svelte-kit/cloudflare"

# ============================================================================
# HIPAA COMPLIANCE NOTICE
# ============================================================================
# This default configuration is NOT HIPAA compliant for PHI storage.
#
# For HIPAA compliance:
# 1. Upgrade to Cloudflare Enterprise plan
# 2. Execute Business Associate Agreement (BAA) with Cloudflare
# 3. Use DEDICATED D1 database (not shared with other templates)
# 4. Enable audit logging via Cloudflare Logpush
# 5. Configure regional data residency as required
# 6. See HIPAA_COMPLIANCE.md for full requirements
#
# Contact Cloudflare sales for BAA: https://www.cloudflare.com/plans/enterprise/
# ============================================================================

# D1 Database
# CURRENT: Shared with templates-platform (NOT HIPAA compliant)
# FOR HIPAA: Create dedicated database and update configuration below
[[d1_databases]]
binding = "DB"
database_name = "templates-platform-db"  # HIPAA: Change to dedicated database
database_id = "a06516a5-6c4b-472f-8826-d730e3a74926"  # HIPAA: Update with new ID

# HIPAA-compliant D1 configuration (commented out by default):
# Create dedicated database: wrangler d1 create medical-practice-hipaa-db
# [[d1_databases]]
# binding = "DB"
# database_name = "medical-practice-hipaa-db"
# database_id = "YOUR_DEDICATED_DATABASE_ID"

# KV Namespace - Session cache, rate limiting
# HIPAA: KV covered under Cloudflare Enterprise BAA
[[kv_namespaces]]
binding = "KV"
id = "bcb39a6258fe49b79da9dc9b09440934"

# KV for production (create separately for HIPAA compliance):
# wrangler kv:namespace create "SESSIONS" --env production
# [[kv_namespaces]]
# binding = "SESSIONS"
# id = "YOUR_PRODUCTION_KV_ID"

# R2 Bucket - Patient documents, forms
# HIPAA: R2 covered under Cloudflare Enterprise BAA
# HIPAA: Enable object versioning and lifecycle policies
[[r2_buckets]]
binding = "R2"
bucket_name = "medical-practice-documents"

# HIPAA: Configure R2 bucket with versioning and encryption
# wrangler r2 bucket create medical-practice-hipaa-documents
# Enable versioning via dashboard or API

# ============================================================================
# ENVIRONMENT VARIABLES
# ============================================================================

[vars]
ENVIRONMENT = "production"

# HIPAA: Do NOT store sensitive values here
# Use wrangler secrets for sensitive configuration:
# wrangler secret put HIPAA_ENCRYPTION_KEY
# wrangler secret put SENDGRID_API_KEY
# wrangler secret put TWILIO_AUTH_TOKEN

# Feature flags (enable after HIPAA configuration)
# FEATURE_PATIENT_PORTAL = "false"
# FEATURE_INTAKE_FORMS = "false"
# FEATURE_APPOINTMENT_REMINDERS = "false"

# Security settings
# AUDIT_LOG_ENABLED = "true"
# SESSION_TIMEOUT = "900"  # 15 minutes (HIPAA recommended)

# ============================================================================
# LOGPUSH (Required for HIPAA audit trails)
# ============================================================================
# Configure Logpush via Cloudflare dashboard or API
# Push logs to S3, Azure Blob Storage, or GCS for long-term retention
# Minimum 6-year retention required for HIPAA
#
# Example destinations:
# - s3://your-hipaa-logs-bucket/cloudflare-logs
# - azblob://your-storage-account/hipaa-logs
# - gs://your-gcs-bucket/cloudflare-logs
#
# See: https://developers.cloudflare.com/logs/get-started/enable-destinations/

# ============================================================================
# REGIONAL DATA RESIDENCY (Enterprise only)
# ============================================================================
# Configure if required for compliance or data sovereignty
# [env.production.data_residency]
# region = "us"  # Options: us, eu, etc.

# ============================================================================
# NOTES
# ============================================================================
# - Default configuration suitable for informational website only
# - PHI handling requires Enterprise plan + BAA + additional configuration
# - See HIPAA_COMPLIANCE.md for complete setup instructions
# - Test thoroughly in development before production deployment
